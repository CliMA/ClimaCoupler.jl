<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interfacer · ClimaCoupler.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ClimaCoupler.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaCoupler.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Sea Breeze</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/sea_breeze/atmos_rhs/">Atmospheric Model</a></li><li><a class="tocitem" href="../generated/sea_breeze/land_rhs/">Land Model</a></li><li><a class="tocitem" href="../generated/sea_breeze/ocean_rhs/">Ocean Model</a></li><li><a class="tocitem" href="../generated/sea_breeze/run/">Coupled Sea Breeze</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">AMIP</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/amip/coupler_driver_modular/">AMIP Driver</a></li></ul></li></ul></li><li><span class="tocitem">Coupler Interface</span><ul><li><a class="tocitem" href="../couplerstate/">Coupler State</a></li><li><a class="tocitem" href="../timestepping/">Coupled Simulations &amp; Timestepping</a></li><li><a class="tocitem" href="../regridder/">Regridder</a></li><li><a class="tocitem" href="../conservation/">Conservation Checks</a></li><li><a class="tocitem" href="../utilities/">Utilities</a></li><li><a class="tocitem" href="../bcreader/">BCReader</a></li><li><a class="tocitem" href="../testhelper/">TestHelper</a></li><li><a class="tocitem" href="../timemanager/">TimeManager</a></li></ul></li><li><span class="tocitem">Performance</span><ul><li><a class="tocitem" href="../performance/">Performance Analysis Tools</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Interfacer</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interfacer</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimaCoupler.jl/blob/main/docs/src/interfacer.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Interfacer"><a class="docs-heading-anchor" href="#Interfacer">Interfacer</a><a id="Interfacer-1"></a><a class="docs-heading-anchor-permalink" href="#Interfacer" title="Permalink"></a></h1><p>This module contains functions for defining the interface for coupling component models, as well as stub objects that contain prescribed fields.</p><h2 id="Coupled-Simulation"><a class="docs-heading-anchor" href="#Coupled-Simulation">Coupled Simulation</a><a id="Coupled-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Coupled-Simulation" title="Permalink"></a></h2><ul><li><code>CoupledSimulation</code> (<code>cs</code>, currently in Utilities - TODO) stores info for ESM run. We require that each <code>cs</code> contains four (<code>atmos_sim</code>, <code>land_sim</code>, <code>ocean_sim</code> and <code>ice_sim</code>) components. While this requirement will not be eventually needed, for the time being, if a simulation surface type is not needed for a given run, it should be initialized with <code>SurfaceStub</code> with a zero <code>area_fracion</code>. The <code>atmos_sim</code> should always be specified.</li></ul><h2 id="Component-model-simulations"><a class="docs-heading-anchor" href="#Component-model-simulations">Component model simulations</a><a id="Component-model-simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Component-model-simulations" title="Permalink"></a></h2><ul><li>all Simulations that are not the <code>CoupledSimulation</code> fall under <code>ComponentModelSimulation</code></li><li>the current version requires that there is:<ul><li>one <code>AtmosModelSimulation</code></li><li>one or more <code>SurfaceModelSimulation</code>s, which require the following adapter functions:   <code>get_field(sim::SurfaceModelSimulation, ::Val{:area_fraction}) = ...   get_field(sim::SurfaceModelSimulation, ::Val{:surface_temperature}) = ...   get_field(sim::SurfaceModelSimulation, ::Val{:albedo}) = ...   get_field(sim::SurfaceModelSimulation, ::Val{:roughness_momentum}) = ...   get_field(sim::SurfaceModelSimulation, ::Val{:roughness_buoyancy}) = ...   get_field(sim::SurfaceModelSimulation, ::Val{:beta}) = ...   update_field!(sim::SurfaceModelSimulation, ::Val{:area_fraction}, field::Fields.Field) = ...   update_field!(sim::SurfaceModelSimulation, ::Val{:surface_temperature}, field::Fields.Field) = ...</code><ul><li>these adapter functions, to be defined in the component models&#39; init files (preferably in their own repositories), allow the coupler to operate without having to assume particular data structures of the underlying component models. This allows easy swapping of model components, as well as a stable source code with coupler-specific unit tests.</li></ul></li></ul></li></ul><h2 id="Prescribed-conditions"><a class="docs-heading-anchor" href="#Prescribed-conditions">Prescribed conditions</a><a id="Prescribed-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Prescribed-conditions" title="Permalink"></a></h2><ul><li><code>SurfaceStub</code> is a <code>SurfaceModelSimulation</code>, but it only contains required data in <code>&lt;surface_stub&gt;.cache</code>, e.g., for the calculation of surface fluxes through a prescribed surface state.  The above adapter functions are already predefined for <code>SurfaceStub</code>, with the cache variables specified as:</li></ul><pre><code class="nohighlight hljs">get_field(sim::SurfaceStub, ::Val{:area_fraction}) = sim.cache.area_fraction
get_field(sim::SurfaceStub, ::Val{:surface_temperature}) = sim.cache.T_sfc
get_field(sim::SurfaceStub, ::Val{:albedo}) = sim.cache.α
get_field(sim::SurfaceStub, ::Val{:roughness_momentum}) = sim.cache.z0m
get_field(sim::SurfaceStub, ::Val{:roughness_buoyancy}) = sim.cache.z0b
get_field(sim::SurfaceStub, ::Val{:beta}) = sim.cache.beta</code></pre><p>with the corresponding <code>update_field!</code> functions</p><pre><code class="nohighlight hljs">function update_field!(sim::SurfaceStub, ::Val{:area_fraction}, field::Fields.Field)
    sim.cache.area_fraction .= field
end
function update_field!(sim::SurfaceStub, ::Val{:surface_temperature}, field::Fields.Field)
    sim.cache.T_sfc .= field
end</code></pre><h2 id="Interfacer-API"><a class="docs-heading-anchor" href="#Interfacer-API">Interfacer API</a><a id="Interfacer-API-1"></a><a class="docs-heading-anchor-permalink" href="#Interfacer-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimaCoupler.Interfacer.ComponentModelSimulation" href="#ClimaCoupler.Interfacer.ComponentModelSimulation"><code>ClimaCoupler.Interfacer.ComponentModelSimulation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ComponentModelSimulation</code></pre><p>An abstract type encompassing all component model (and model stub) simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCoupler.jl/blob/2c45c688e77369a7079b48f56b8079b81b9ba2fa/src/Interfacer.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaCoupler.Interfacer.AtmosModelSimulation" href="#ClimaCoupler.Interfacer.AtmosModelSimulation"><code>ClimaCoupler.Interfacer.AtmosModelSimulation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AtmosModelSimulation</code></pre><p>An abstract type for an atmospheric model simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCoupler.jl/blob/2c45c688e77369a7079b48f56b8079b81b9ba2fa/src/Interfacer.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaCoupler.Interfacer.SurfaceModelSimulation" href="#ClimaCoupler.Interfacer.SurfaceModelSimulation"><code>ClimaCoupler.Interfacer.SurfaceModelSimulation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurfaceModelSimulation</code></pre><p>An abstract type for surface model simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCoupler.jl/blob/2c45c688e77369a7079b48f56b8079b81b9ba2fa/src/Interfacer.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaCoupler.Interfacer.SurfaceStub" href="#ClimaCoupler.Interfacer.SurfaceStub"><code>ClimaCoupler.Interfacer.SurfaceStub</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurfaceStub</code></pre><p>On object containing simulation-like info, used as a stub or for prescribed data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCoupler.jl/blob/2c45c688e77369a7079b48f56b8079b81b9ba2fa/src/Interfacer.jl#L47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaCoupler.Interfacer.name" href="#ClimaCoupler.Interfacer.name"><code>ClimaCoupler.Interfacer.name</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">name(::ComponentModelSimulation)</code></pre><p>Returns simulation name, if defined, or <code>Unnamed</code> if not.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCoupler.jl/blob/2c45c688e77369a7079b48f56b8079b81b9ba2fa/src/Interfacer.jl#L119-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaCoupler.Interfacer.get_field" href="#ClimaCoupler.Interfacer.get_field"><code>ClimaCoupler.Interfacer.get_field</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_field(::SurfaceStub, ::Val)</code></pre><p>A getter function, that should not allocate. If undefined, it returns a descriptive error.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCoupler.jl/blob/2c45c688e77369a7079b48f56b8079b81b9ba2fa/src/Interfacer.jl#L56-L60">source</a></section><section><div><pre><code class="nohighlight hljs">get_field(::ComponentModelSimulation, ::Val, colidx::Fields.ColumnIndex)</code></pre><p>Extension of <code>get_field(::ComponentModelSimulation, ::Val)</code>, indexing into the specified colum index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCoupler.jl/blob/2c45c688e77369a7079b48f56b8079b81b9ba2fa/src/Interfacer.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaCoupler.Interfacer.update_field!" href="#ClimaCoupler.Interfacer.update_field!"><code>ClimaCoupler.Interfacer.update_field!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">update_field!(::ComponentModelSimulation, ::Val, _...)</code></pre><p>No update in unspecified in the particular component model simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCoupler.jl/blob/2c45c688e77369a7079b48f56b8079b81b9ba2fa/src/Interfacer.jl#L87-L91">source</a></section><section><div><pre><code class="nohighlight hljs">update_field!(sim::SurfaceStub, ::Val{:area_fraction}, field::Fields.Field)</code></pre><p>Updates the specified value in the cache of <code>SurfaceStub</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCoupler.jl/blob/2c45c688e77369a7079b48f56b8079b81b9ba2fa/src/Interfacer.jl#L104-L108">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 18 September 2023 21:29">Monday 18 September 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
